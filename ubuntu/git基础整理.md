## 概念须知

1. 文件流转的 4 个区域

   - 工作区(本地文件目录)
   - 缓存区
   - 本地版本库
   - 远程仓库

2. 文件存在的几个不同状态

   - untracked,未追踪状态,文件从未被 add 进缓存区过
   - 其余都属于 tracked 状态,即已被 Git 仓库追踪,细分为以下几个状态
     - staged,已缓存状态
     - unstaged,缓存过后取消缓存状态,进过缓存再取消与 untracked 状态不同
     - commit,已提交状态
     - modified,已修改状态,该状态可与 staged 状态或 commited 状态同时存在

## 基础命令

1. _**init**_

   - 初始化 git 仓库
   - 新增.git 子目录
   - 此时文件属于 untracked 未追踪状态

2. _**add**_

   - 将工作区文件 add 到缓存区
   - 此时文件属于 tracked 追踪状态之中的 staged 已缓存状态

3. _**commit**_

   - 将缓存区文件提交到本地版本库
   - 此时文件属于 commited 状态
   - 返回信息中会提示本次提交的分支,以及本次提交完整的SHA-1校验和(形如463dc4f)

4. _**log**_ 与 _**reflog**_

   - `log` 查询`commit` 提交记录
   - `reflog` 查询`commit` 操作记录
   - 区别在于`reflog` 支持查询被删除或重置的`commit` 记录，而`log` 不支持

5. _**status**_

   - 查询文件在工作区与缓存区的状态
   - _-s_ 参数用于对状态进行简短化输出

     - _??_ 表示文件处于 untracked 状态
     - _A_ 表示文件处于 staged 已缓存状态
     - _M_ 表示文件处于 modified 状态
     - _D_ 表示工作区文件已被删除

6. _**diff**_

   - 查询缓存区与工作区的文件具体区别
   - _--cached_ 选项查询本地版本库与缓存区文件的具体区别
   - _HEAD_ 参数查询最近一次`commited` 状态文件与工作区文件的具体区别
   - _--stat_ 选项支持以摘要形式显示具体区别

7. _**reset**_

   - _filename_ 取消缓存区文件 staged 状态到 unstaged 状态
   - _HEAD~n_ (最近一次提交的前 n 次提交)或 _commitID_ (具体提交 ID) 参数将本地版本库与缓存区重置为参数对应 commited 状态文件
   - _--soft_ 选项支持仅重置本地版本库而不重置缓存区
   - _--hard_ 选项支持将工作区也重置为对应 _commited_ 状态文件

8. _**rm**_

   - _filename_ 将文件从缓存区和工作区删除
   - _--cached_ 选项支持保留工作区文件,_此时保留的工作区文件为 untracked 状态_

9. _**restore**_

   - _filename_ 从缓存区恢复文件到工作区
   - _-S 或--staged_ 从本地版本库恢复文件到缓存区
   - _-W_ 或 _--worktree_ 从本地版本库恢复文件到工作区
   - `git rm` 删除的文件由于是 _untracked_ 状态无法通过 _**restore**_ 恢复但可通过 _**reset**_ 恢复

## 忽略文件.gitignore

1. 对于无需纳入版本管理的文件,避免每次在`untracked`列表中出现,可以创建 _**.gitignore**_ 文件来声明需要被忽略的文件
2. _**.gitignore**_ 文件格式规范

   - 空行以及#开头的注释行会被忽略
   - 匹配模式可以以`/x`开头防止递归(只忽略当前目录下的 x 文件, 而不忽略子目录下的 x 文件)
   - 匹配模式可以以`x/`结尾来指定目录(忽略任何目录下的 x 目录及其内容)
   - 标准的 glob 模式匹配(shell 所使用的简化版正则表达式),递归的应用在整个工作区

     - _\*_ 号匹配 0 或 n 个任意字符
     - 匹配任何一个列在方括号中的字符,如 _[abc]_ 匹配 a 或匹配 b 或匹配 c
     - _?_ 号只匹配一个任意字符
     - 匹配字符范围内的字符,如 _[0-9]_ 匹配 0 到 9 闭区间中的任意一个数
     - _\*\*_ 双星号表示匹配任意中间目录,如 a/\*\*/z 可以匹配 a/z,a/b/z,a/b/c/d/z
     - 使用 _!_ 取反,通常用于取消某类忽略中的部分,如先忽略所有的\*.txt 文件,但其中的!a.txt 不忽略

## Git 分支管理

#### 概念理解

每一个 commited 对象都是一个节点,父节点是上一次提交对象,子节点是下一次提交对象,若干次提交后,节点组成一个分支,不同的分支不过是在节点上新建不同的指针,指向不同的子节点

在新分支中创建的文件

- untracked 时，所有分支均可查阅
- staged 时，不允许切换分支，需要 stash 另存（该操作会清空新分支的工作区与缓存区，等待 apply 回工作区）
- commited 时，只能在新分支中查阅
